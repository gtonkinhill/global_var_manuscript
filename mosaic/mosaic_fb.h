#if !defined MOSAIC_H
#define MOSAIC_H


#include<stdlib.h>
#include<stdio.h>
#include<math.h>
#include<string.h>
#include<time.h>

#define NSTATE_AA 25
#define NSTATE_NT 5
#define SMALL -1e6
#define VERYSMALL -9999999.0


long *idum;

		/*Amino acids - IUPAC convention

	    Abbreviation    Amino acid name
        ------------    ---------------

		???		? 0		 Missing data
        Ala     A 1      Alanine
        Arg     R 2      Arginine
        Asn     N 3      Asparagine
        Asp     D 4      Aspartic acid (Aspartate)
        Cys     C 5      Cysteine
        Gln     Q 6      Glutamine
        Glu     E 7      Glutamic acid (Glutamate)
        Gly     G 8      Glycine
        His     H 9      Histidine
        Ile     I 10     Isoleucine
        Leu     L 11     Leucine
        Lys     K 12     Lysine
        Met     M 13     Methionine
        Phe     F 14     Phenylalanine
        Pro     P 15     Proline
        Ser     S 16     Serine
        Thr     T 17     Threonine
        Trp     W 18     Tryptophan
        Tyr     Y 19     Tyrosine
        Val     V 20     Valine
        Asx     B 21     Aspartic acid or Asparagine
        Glx     Z 22     Glutamine or Glutamic acid.
        Xaa     X 23     Any amino acid.
        TERM    * 24     termination codon

*/

/*For amino acids*/

// /*Initial iteration*/

// double emiss_gap_aa[NSTATE_AA]={-3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825};


// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825},\
// {-3.218875825, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031}};


/*Second iteration*/

// double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};


// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-12.0991720557,-0.129119256276,-5.94219307009,-4.91758011107,-4.43858659397,-6.86806343882,-5.56538321774,-4.3494186494,-4.3716369452,-5.51438066329,-5.78925377745,-4.96587610078,-4.4580878065,-8.73187622569,-8.31498242176,-4.93367858062,-4.76353807375,-4.12877714849,-8.38559998897,-6.57371911655,-4.66550551551,-12.0991720557,-12.0991720557,-11.4060248751,-12.0991720557},\
// {-12.5564160877,-6.28921553921,-0.0754123186913,-5.58944894913,-5.99538542185,-7.76062554215,-5.06087414386,-5.38552760924,-4.99529449822,-5.16623465952,-6.24105808623,-5.66988444522,-3.88890813567,-7.76892434497,-8.54908290252,-6.06873206926,-5.57262612249,-5.34633645958,-7.60765619737,-6.23026661459,-7.03495516989,-12.5564160877,-12.5564160877,-11.4578037991,-12.5564160877},\
// {-12.5054732866,-5.44328165427,-5.62406198292,-0.143585632681,-3.63579391183,-8.86788712683,-5.2512954401,-4.58575352564,-4.35558274216,-5.50059129685,-6.00268324065,-7.16793520686,-3.39860632306,-8.08663267876,-7.57099935343,-6.14589941789,-4.46793010144,-4.73651724202,-9.50974101301,-5.13650288437,-6.79504626919,-12.5054732866,-12.5054732866,-12.5054732866,-12.5054732866},\
// {-12.8622290248,-5.28613168421,-6.54687102331,-3.98652258021,-0.0959264942506,-9.33586850022,-5.56649395208,-4.01645176965,-4.45418128068,-6.03351695319,-6.9650751572,-7.53435285604,-4.50567417938,-8.19878993072,-9.12455940655,-6.26781556508,-5.29695374294,-4.99359213065,-9.68417519449,-6.01847907583,-6.61225378257,-12.8622290248,-12.8622290248,-11.4759346637,-12.8622290248},\
// {-11.68168041,-7.00885157558,-7.37761531684,-8.09816147159,-8.31438458006,-0.00896022285964,-8.54618619411,-8.84846706599,-6.85336667274,-9.48445583271,-7.96810834334,-7.74985477732,-8.0707624974,-10.0722424976,-7.60414296614,-7.57080654587,-6.99954918292,-8.68594813649,-8.9090916878,-6.87765936531,-6.99033252781,-11.68168041,-11.68168041,-10.5830681214,-11.68168041},\
// {-12.0267485917,-5.43370405759,-4.61338125604,-4.76552349976,-4.65149281372,-8.65945276175,-0.166340301192,-3.84586764974,-5.09137814572,-5.29334669989,-5.50025373216,-5.86976960615,-2.83182647248,-7.19046668478,-8.0194154065,-5.40135622372,-5.7041833518,-4.87369695679,-7.82205597234,-6.03778717484,-5.82017266501,-12.0267485917,-12.0267485917,-11.3336014112,-12.0267485917},\
// {-12.3688417937,-4.6470500169,-5.34508283898,-4.4436842815,-3.5342135717,-8.75792388108,-4.18321290257,-0.164059980957,-4.23349484481,-5.77442833397,-6.97521424737,-6.57888162282,-3.28758557516,-8.12034655167,-8.81349373223,-5.71340144335,-5.15950153712,-4.63078949603,-8.65526972702,-6.52820013635,-6.03024771552,-12.3688417937,-12.3688417937,-10.289400252,-12.3688417937},\
// {-12.5531597729,-4.88273125071,-5.12482657871,-4.37171907718,-4.08789165435,-7.7909858381,-5.66153387585,-4.39064352276,-0.107586092142,-6.29740973115,-6.74201877992,-6.74802480398,-4.21437580146,-8.42602538785,-7.6779624497,-5.64340649125,-4.68452287872,-5.11477624286,-7.25484240635,-7.03973102673,-5.89771942253,-12.5531597729,-12.5531597729,-12.5531597729,-12.5531597729},\
// {-10.8689302879,-4.32934433225,-3.46221955769,-3.88514032261,-4.00199700341,-7.18005083376,-4.18057557392,-4.2303624987,-4.64834011777,-0.230865745011,-6.51222146118,-5.70414431395,-4.14149856302,-7.82440785015,-6.4744811332,-5.23771850605,-4.77310572544,-4.97452745361,-8.22987295825,-3.28976232047,-6.40302216922,-10.8689302879,-10.8689302879,-10.8689302879,-10.8689302879},\
// {-12.1804624871,-5.82262022062,-5.88889334757,-5.48713881885,-5.88335316719,-8.51690084099,-5.46750628645,-6.4901030328,-6.23242749794,-7.76162187933,-0.0811457748379,-4.56467141509,-5.23252541851,-5.75397402967,-7.00431275455,-7.0805960593,-6.10972475912,-5.09205370845,-8.77926510546,-5.72369283155,-3.71057056883,-12.1804624871,-12.1804624871,-11.4873153066,-12.1804624871},\
// {-12.3600204476,-5.14846371432,-5.47655786122,-6.91328307597,-6.78029062165,-7.88268363316,-6.18415317753,-6.53107483003,-6.43043130425,-7.07175341694,-4.8188679925,-0.0498355652242,-6.30793127871,-6.6730450913,-5.39588483522,-5.76287474575,-6.09281989909,-6.27324572072,-8.11152520559,-5.86778061262,-5.52268763295,-12.3600204476,-12.3600204476,-11.6668732671,-12.3600204476},\
// {-12.9568304988,-5.36648355315,-4.30931104566,-3.84366203853,-4.60239155864,-9.52284329427,-3.77880672826,-3.87762439481,-4.65184091862,-6.23781734437,-6.07439302776,-6.79985151317,-0.139357748618,-7.53188048128,-8.86248593653,-6.05912555563,-5.12046073821,-4.61709073274,-8.76717575673,-6.49692604438,-6.54173353959,-12.9568304988,-12.9568304988,-11.8582182101,-12.9568304988},\
// {-9.54674117747,-6.08100527468,-4.60509875487,-4.52946134066,-4.25847414678,-6.32786535261,-4.43475338912,-4.94157099149,-4.90235027833,-5.93582326483,-3.01295233954,-3.79416853865,-3.95949251907,-0.23285192987,-6.50221873975,-6.77415245524,-5.19003235079,-3.75068342671,-6.90768384786,-5.05810480774,-4.65639204925,-9.54674117747,-9.54674117747,-9.54674117747,-9.54674117747},\
// {-11.8514384749,-7.98023746403,-7.8083872071,-6.71564003789,-7.04741743021,-7.66178373291,-7.88114656139,-8.06724884102,-6.88859384468,-7.67705120504,-6.88859384468,-4.73099410255,-7.77390103103,-9.28648911748,-0.0880267022629,-7.69255539158,-5.92184933155,-7.44471922767,-8.90699949577,-2.75393091124,-7.05564792934,-11.8514384749,-11.8514384749,-11.1582912944,-11.8514384749},\
// {-11.6541385279,-4.43522882025,-5.24067957071,-5.16341499337,-4.93512537349,-7.32340518759,-4.99869817751,-4.95587047376,-4.76760688534,-6.07064221909,-6.6843252283,-5.10305819283,-4.68717138926,-10.0447006154,-7.40564328582,-0.103898010523,-4.95587047376,-4.70812453677,-7.33665041434,-7.21148727138,-4.74838525156,-11.6541385279,-11.6541385279,-10.9609913473,-11.6541385279},\
// {-11.6460830377,-4.37091071828,-4.68478699182,-3.56522661809,-4.07512445456,-6.70444061512,-5.16757339552,-4.45691529931,-3.74878656514,-5.48910405215,-5.5324008579,-5.35266375889,-3.80695138946,-7.67579112418,-5.57765744949,-4.96899957649,-0.203494203833,-3.91987038723,-7.47169576784,-5.20036321835,-5.91923529015,-11.6460830377,-11.6460830377,-10.9529358572,-11.6460830377},\
// {-12.360200468,-4.37880888637,-5.16351389712,-4.63487043004,-4.52067488625,-8.33484877722,-5.32757620693,-4.70433645034,-4.92122887556,-6.78425136481,-5.33288595391,-6.56110781349,-4.01427020597,-6.82681097923,-8.0163950461,-5.5058459657,-4.66535239557,-0.111748640948,-9.14132464309,-5.86191831848,-6.14960039093,-12.360200468,-12.360200468,-11.6670532874,-12.360200468},\
// {-11.4922736772,-7.31788640734,-6.8971538271,-8.54783469807,-8.16006916706,-8.65906033318,-7.1747855637,-7.54102995866,-6.55063125463,-8.60190191934,-9.70051420801,-7.21560755822,-7.52198176369,-9.18968858425,-8.49654140369,-7.16154033695,-7.27276597206,-8.27339785237,-0.0091066344334,-8.54783469807,-8.44775123952,-11.4922736772,-11.4922736772,-11.4922736772,-11.4922736772},\
// {-12.4029625665,-6.8538864816,-6.06084114778,-5.01773164343,-5.56027928426,-7.71161468427,-6.46806837088,-6.66316965432,-6.85778512202,-4.87087442296,-6.58883203467,-6.01945593162,-6.05557335684,-9.26746835057,-3.4087901321,-7.93705444784,-6.067908315,-5.86917372857,-9.07075805632,-0.0740972323825,-7.44011793624,-12.4029625665,-12.4029625665,-10.6112030973,-12.4029625665},\
// {-11.8982286813,-4.45690829154,-6.43016854012,-6.00382584699,-5.5508394716,-6.85480356434,-5.5992794344,-5.44933928711,-5.08478408174,-7.52878082879,-3.51000587114,-5.08478408174,-5.36153708366,-7.17972980996,-7.2442683311,-4.99247540494,-6.27782781554,-5.62346666001,-8.37186815664,-6.9709749961,-0.0955108720231,-11.8982286813,-11.8982286813,-11.2050815007,-11.8982286813},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-4.35670882669,-2.97041446557,-2.56494935746,-2.74727091426,-2.56494935746,-2.97041446557,-2.56494935746,-2.41079867763,-3.25809653802,-3.66356164613,-3.66356164613,-3.66356164613,-3.25809653802,-4.35670882669,-3.66356164613,-3.66356164613,-4.35670882669,-2.41079867763,-4.35670882669,-2.56494935746,-3.25809653802,-4.35670882669,-4.35670882669,-4.35670882669,-4.35670882669},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487}};

/*Third iteration*/

double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};


double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
{{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
{-12.0875311974,-0.0953636592774,-6.23532871758,-5.29294461648,-5.01850777077,-7.36014337864,-5.69729053029,-4.39496154928,-4.34382793918,-5.75247694585,-5.9984863219,-4.93682973976,-4.95423524246,-10.2957717281,-8.79169433135,-5.08628557528,-4.91280688752,-4.52693003458,-9.04300875963,-6.94586764085,-5.98945691519,-12.0875311974,-12.0875311974,-11.3943840168,-12.0875311974},\
{-12.5465724748,-6.62231667737,-0.0579069347299,-5.28675286442,-7.22845248094,-7.9414022888,-5.17382610838,-5.39665563865,-5.15762637717,-5.44985109629,-6.65492826296,-5.42855627032,-4.31946424044,-8.32706476961,-8.8089028565,-6.19568675807,-5.61803465662,-6.39596970634,-7.759080732,-6.67727556165,-9.02021195017,-12.5465724748,-12.5465724748,-11.4479601861,-12.5465724748},\
{-12.4859707514,-5.86990556623,-5.40510285468,-0.0948137025533,-4.52914362928,-9.02023484857,-5.0094983702,-4.57501336852,-4.65713622378,-5.95072948035,-6.61385296189,-6.60543776497,-3.95310108057,-9.22787421334,-7.98616108104,-6.21877020282,-4.54788202447,-5.6540171858,-9.77792055026,-5.38429477975,-9.49023847781,-12.4859707514,-12.4859707514,-12.4859707514,-12.4859707514},\
{-12.8366180948,-5.82180374355,-7.48951056411,-4.71009992605,-0.0450670018389,-11.7380058062,-6.63206033226,-4.41154019232,-5.52941578007,-6.51225913245,-8.06593347036,-8.6469633528,-5.68984591538,-8.57393821779,-10.0034047508,-6.76357356073,-6.36427180033,-5.69695775887,-10.5340330018,-6.34286425498,-7.63261140775,-12.8366180948,-12.8366180948,-11.7380058062,-12.8366180948},\
{-11.6799472414,-7.10523626292,-7.31049938895,-7.70965532787,-9.88818777219,-0.00657098407322,-8.31265141143,-8.84673389736,-6.97946687563,-9.28205196862,-10.2936528803,-7.70965532787,-8.50189341107,-10.9868000609,-8.1535867168,-8.54445302549,-7.1690877349,-9.11499788396,-9.28205196862,-7.00711840696,-10.2936528803,-11.6799472414,-11.6799472414,-10.9868000609,-11.6799472414},\
{-12.0153720827,-5.62849276334,-4.61109296467,-4.43518266476,-5.68743529898,-8.61417470104,-0.126108271878,-3.82862929559,-5.2286551321,-5.66448636599,-5.98228586091,-5.43890251366,-3.31004094917,-7.99002039197,-7.88823769766,-5.48449445498,-5.6151146374,-5.48158324477,-8.301800016,-6.1864264651,-7.48277258955,-12.0153720827,-12.0153720827,-11.3222249021,-12.0153720827},\
{-12.3542943551,-4.67043037487,-5.25840113403,-4.31127346983,-4.0771365827,-9.46392259723,-4.19864508476,-0.12168202341,-4.52109040649,-6.05534510827,-7.27912053989,-6.11401850996,-3.8900800885,-8.77077541667,-8.88855845233,-5.69885400476,-5.25015026214,-4.96534825751,-9.3097719174,-6.64386733775,-7.30443834788,-12.3542943551,-12.3542943551,-10.967999994,-12.3542943551},\
{-12.541043756,-4.6213239951,-5.02515467081,-4.40218700533,-4.74047110135,-7.8589125289,-5.60859586445,-4.54102966235,-0.0805459699446,-6.99586631155,-7.02359085956,-6.64664092176,-4.94364743581,-8.43016989185,-7.87760466191,-5.81481035367,-4.95170793285,-6.1660189362,-7.23277605862,-7.52376391921,-6.89559685838,-12.541043756,-12.541043756,-12.541043756,-12.541043756},\
{-10.8613424035,-4.44297746755,-3.63077925008,-4.08028477755,-4.56607640205,-7.36483484202,-4.40143794911,-4.44297746755,-5.14103062688,-0.191805782408,-6.31804762122,-5.76759220268,-4.21365402992,-8.55875731049,-6.83599071275,-5.50475612882,-4.70860970878,-5.9785404809,-7.81681996576,-3.18951560561,-8.66411782615,-10.8613424035,-10.8613424035,-10.8613424035,-10.8613424035},\
{-12.1668535324,-6.084634622,-6.20070679325,-5.89775724867,-6.57214215277,-9.86426843938,-6.49009973011,-6.76869083086,-6.91458010433,-7.47550565015,-0.0547289946911,-4.88960580574,-5.35891858868,-5.84788541863,-7.27650440415,-7.40467959758,-6.37383992399,-5.42988657437,-9.03135931645,-6.13137209985,-4.15384142201,-12.1668535324,-12.1668535324,-12.1668535324,-12.1668535324},\
{-12.3503807601,-5.22188481445,-5.2611376051,-6.42079161674,-8.85387319866,-7.78603256866,-5.82535110228,-6.25455619769,-6.75939377962,-7.2877857271,-5.05804358395,-0.0398354929992,-6.57582921458,-7.30052475288,-5.8180464679,-5.97706097055,-6.10233788562,-7.62299294141,-8.52173936364,-6.22351157601,-7.26897639514,-12.3503807601,-12.3503807601,-12.3503807601,-12.3503807601},\
{-12.9452108382,-5.5062392458,-4.45992119579,-3.94818745671,-5.23455751469,-9.68711430017,-4.06573843612,-4.12053294703,-5.22741462718,-6.15062425731,-5.99152662732,-6.56508830129,-0.106771271028,-8.13302648282,-10.1119974941,-6.44242079228,-5.07848855305,-5.09744830072,-9.20754121991,-6.62624272444,-7.67735267913,-12.9452108382,-12.9452108382,-12.9452108382,-12.9452108382},\
{-9.52973911098,-6.09575190649,-4.76756517618,-4.64693718839,-4.59526517785,-7.4502975693,-4.98644432871,-4.96539091951,-5.00795053393,-6.35168528063,-3.02844944044,-4.08300173931,-4.49930118959,-0.182248900856,-6.43869665762,-6.58530013181,-5.5784953924,-4.15910108285,-5.5784953924,-5.14771247631,-5.37085602762,-9.52973911098,-9.52973911098,-9.52973911098,-9.52973911098},\
{-11.8474457979,-8.06325616395,-8.01880440138,-6.68265982394,-8.32108527325,-7.78700278732,-7.76990835396,-7.72031141282,-7.04342475313,-7.8584617513,-6.93479091213,-4.87203187041,-9.20838846825,-9.2824964404,-0.0823151903077,-8.08624568217,-6.0126350608,-8.06325616395,-9.65022122053,-2.78120676986,-7.87715388431,-11.8474457979,-11.8474457979,-11.8474457979,-11.8474457979},\
{-11.6517826504,-4.53133827796,-5.15500766016,-4.81767391154,-5.37513916101,-7.70053893177,-4.79532066576,-4.76423007869,-4.90302310286,-6.29519637568,-6.68893802009,-5.11654137934,-5.42722422107,-9.45455807301,-7.37511653133,-0.0895243113612,-4.8165980642,-5.02771742255,-7.49289956699,-7.20913139386,-6.48699667643,-11.6517826504,-11.6517826504,-10.9586354698,-11.6517826504},\
{-11.6363547527,-4.44945373231,-4.65627881216,-3.5481000256,-4.96179336091,-6.77654234836,-5.10693591446,-4.47395725537,-4.11829057149,-5.67277540911,-5.8587024295,-5.24779334718,-4.10426660918,-8.45830092238,-5.73920088509,-4.93932050506,-0.153960662791,-4.8887682259,-7.78620715101,-5.53828047056,-8.13984719126,-11.6363547527,-11.6363547527,-11.6363547527,-11.6363547527},\
{-12.3340963989,-4.80415302831,-6.03698707898,-5.28657917756,-5.24735846441,-9.50088305486,-5.85558675671,-4.98422269418,-5.90760794146,-8.07141652187,-5.58650987209,-7.37125176866,-4.75543954832,-7.34366381214,-8.44227610081,-5.84034255906,-5.42234909866,-0.05899221598,-10.9478020378,-6.41520254464,-7.24034619811,-12.3340963989,-12.3340963989,-11.6409492184,-12.3340963989},\
{-11.4909763356,-7.80209688147,-6.8858061496,-8.27210051072,-8.85191900597,-8.92602697812,-7.57895333016,-8.23287979756,-6.34348185877,-9.29375175825,-9.54506618653,-7.7533067173,-8.78292613448,-8.85191900597,-9.69921686636,-7.90745739713,-7.55915070286,-9.41153479391,-0.00661496774041,-9.41153479391,-10.1046819745,-11.4909763356,-11.4909763356,-11.4909763356,-11.4909763356},\
{-12.3981836291,-7.22203389657,-6.41676941789,-5.17634780386,-5.91354839351,-7.79301344316,-6.7112082728,-6.76339402597,-7.64459343804,-4.85279387953,-6.79976167015,-6.19362586658,-6.54598114937,-9.50781187125,-3.48651887109,-8.30383906692,-6.35792891787,-6.34609446022,-10.0955985361,-0.0630100158435,-8.54803602743,-12.3981836291,-12.3981836291,-10.7887457167,-12.3981836291},\
{-11.9006542096,-4.42135457181,-6.37520127046,-5.83222862134,-5.0676224768,-7.32594323108,-5.19992310004,-5.38594151872,-4.88135755587,-7.30553435945,-3.30779711425,-5.11393725898,-4.95656700136,-7.17326639088,-7.05646712313,-4.8795702453,-6.13860282681,-5.28191522607,-8.28973629694,-6.70215717832,-0.116099837488,-11.9006542096,-11.9006542096,-10.5143598485,-11.9006542096},\
{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
{-4.40671924726,-3.3081069586,-2.61495977804,-2.79728133483,-2.46080909821,-3.02042488614,-2.61495977804,-2.46080909821,-3.7135720667,-3.7135720667,-3.7135720667,-3.3081069586,-2.61495977804,-4.40671924726,-3.3081069586,-3.7135720667,-3.7135720667,-2.46080909821,-4.40671924726,-2.61495977804,-3.7135720667,-4.40671924726,-4.40671924726,-4.40671924726,-4.40671924726},\
{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487}};




double char_frequencies[NSTATE_AA]={2.55575050252e-7,0.0458355962374,0.0719062959636,0.068612700291,0.0976207240697,0.0297558363757,0.0424372147942,0.0599525397132,0.0720818760231,0.0134851619515,0.049724170627,0.0591395554783,0.107938288848,0.00386480590992,0.0354577157469,0.0294207774849,0.0300244457536,0.0595471976835,0.0244915014906,0.0612035795842,0.0375048718994,2.55575050252e-7,2.55575050252e-7,5.11150100505e-7,2.55575050252e-7};

/*
For nucleotides

	NUC		NUM
	---		---
	?		0
	T		1
	C		2
	A		3
	G		4
*/


double emiss_gap_nt[NSTATE_NT]={-2.995732274, -1.437587656, -1.437587656, -1.437587656, -1.437587656};

double emiss_match_nt[NSTATE_NT][NSTATE_NT]=\
{{-2.995732274, -2.995732274, -2.995732274, -2.995732274, -2.995732274},\
{-1.437587656, -0.105360516, -4.094344562, -4.094344562, -4.094344562},\
{-1.437587656, -4.094344562, -0.105360516, -4.094344562, -4.094344562},\
{-1.437587656, -4.094344562, -4.094344562, -0.105360516, -4.094344562},\
{-1.437587656, -4.094344562, -4.094344562, -4.094344562, -0.105360516}};


/*Structures*/

/*Stores all matrices - don't want to allocate them all the time*/
struct matrices {

	double ***m1_m;
	double ***m1_i;
	double ***m1_d;
	double ***m2_m;
	double ***m2_i;
	double ***m2_d;

	int *who_copy;

	int *maxpath_copy;
	int *maxpath_state;
	int *maxpath_pos;
	double *ppsum_match;
	double **ppsum_state;

	int maxl;
	double llk;

	double tb_divisor;

};



/*Function declarations*/

struct pars * get_pars(int argc, char *argv[]);
void kalign_fb(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
struct data * add_null_term(struct data *my_data);
void classify_sequences(struct pars *my_pars, struct data *my_data);
struct matrices * allocate_matrices(struct data *my_data, struct pars *my_pars);
void deallocate_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices);
void print_max_acc_alignment(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
void print_posterior_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
void print_forward_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target, FILE *ofp);
void print_backward_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target, FILE *ofp);
void kalign_vt(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);

#endif


