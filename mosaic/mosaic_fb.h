#if !defined MOSAIC_H
#define MOSAIC_H


#include<stdlib.h>
#include<stdio.h>
#include<math.h>
#include<string.h>
#include<time.h>

#define NSTATE_AA 25
#define NSTATE_NT 5
#define SMALL -1e6
#define VERYSMALL -9999999.0


long *idum;

		/*Amino acids - IUPAC convention

	    Abbreviation    Amino acid name
        ------------    ---------------

		???		? 0		 Missing data
        Ala     A 1      Alanine
        Arg     R 2      Arginine
        Asn     N 3      Asparagine
        Asp     D 4      Aspartic acid (Aspartate)
        Cys     C 5      Cysteine
        Gln     Q 6      Glutamine
        Glu     E 7      Glutamic acid (Glutamate)
        Gly     G 8      Glycine
        His     H 9      Histidine
        Ile     I 10     Isoleucine
        Leu     L 11     Leucine
        Lys     K 12     Lysine
        Met     M 13     Methionine
        Phe     F 14     Phenylalanine
        Pro     P 15     Proline
        Ser     S 16     Serine
        Thr     T 17     Threonine
        Trp     W 18     Tryptophan
        Tyr     Y 19     Tyrosine
        Val     V 20     Valine
        Asx     B 21     Aspartic acid or Asparagine
        Glx     Z 22     Glutamine or Glutamic acid.
        Xaa     X 23     Any amino acid.
        TERM    * 24     termination codon

*/

/*For amino acids*/

// /*Initial iteration*/

// double emiss_gap_aa[NSTATE_AA]={-3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825};


// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825},\
// {-3.218875825, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031}};


/*Second iteration*/

// double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};


// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-12.0991720557,-0.129119256276,-5.94219307009,-4.91758011107,-4.43858659397,-6.86806343882,-5.56538321774,-4.3494186494,-4.3716369452,-5.51438066329,-5.78925377745,-4.96587610078,-4.4580878065,-8.73187622569,-8.31498242176,-4.93367858062,-4.76353807375,-4.12877714849,-8.38559998897,-6.57371911655,-4.66550551551,-12.0991720557,-12.0991720557,-11.4060248751,-12.0991720557},\
// {-12.5564160877,-6.28921553921,-0.0754123186913,-5.58944894913,-5.99538542185,-7.76062554215,-5.06087414386,-5.38552760924,-4.99529449822,-5.16623465952,-6.24105808623,-5.66988444522,-3.88890813567,-7.76892434497,-8.54908290252,-6.06873206926,-5.57262612249,-5.34633645958,-7.60765619737,-6.23026661459,-7.03495516989,-12.5564160877,-12.5564160877,-11.4578037991,-12.5564160877},\
// {-12.5054732866,-5.44328165427,-5.62406198292,-0.143585632681,-3.63579391183,-8.86788712683,-5.2512954401,-4.58575352564,-4.35558274216,-5.50059129685,-6.00268324065,-7.16793520686,-3.39860632306,-8.08663267876,-7.57099935343,-6.14589941789,-4.46793010144,-4.73651724202,-9.50974101301,-5.13650288437,-6.79504626919,-12.5054732866,-12.5054732866,-12.5054732866,-12.5054732866},\
// {-12.8622290248,-5.28613168421,-6.54687102331,-3.98652258021,-0.0959264942506,-9.33586850022,-5.56649395208,-4.01645176965,-4.45418128068,-6.03351695319,-6.9650751572,-7.53435285604,-4.50567417938,-8.19878993072,-9.12455940655,-6.26781556508,-5.29695374294,-4.99359213065,-9.68417519449,-6.01847907583,-6.61225378257,-12.8622290248,-12.8622290248,-11.4759346637,-12.8622290248},\
// {-11.68168041,-7.00885157558,-7.37761531684,-8.09816147159,-8.31438458006,-0.00896022285964,-8.54618619411,-8.84846706599,-6.85336667274,-9.48445583271,-7.96810834334,-7.74985477732,-8.0707624974,-10.0722424976,-7.60414296614,-7.57080654587,-6.99954918292,-8.68594813649,-8.9090916878,-6.87765936531,-6.99033252781,-11.68168041,-11.68168041,-10.5830681214,-11.68168041},\
// {-12.0267485917,-5.43370405759,-4.61338125604,-4.76552349976,-4.65149281372,-8.65945276175,-0.166340301192,-3.84586764974,-5.09137814572,-5.29334669989,-5.50025373216,-5.86976960615,-2.83182647248,-7.19046668478,-8.0194154065,-5.40135622372,-5.7041833518,-4.87369695679,-7.82205597234,-6.03778717484,-5.82017266501,-12.0267485917,-12.0267485917,-11.3336014112,-12.0267485917},\
// {-12.3688417937,-4.6470500169,-5.34508283898,-4.4436842815,-3.5342135717,-8.75792388108,-4.18321290257,-0.164059980957,-4.23349484481,-5.77442833397,-6.97521424737,-6.57888162282,-3.28758557516,-8.12034655167,-8.81349373223,-5.71340144335,-5.15950153712,-4.63078949603,-8.65526972702,-6.52820013635,-6.03024771552,-12.3688417937,-12.3688417937,-10.289400252,-12.3688417937},\
// {-12.5531597729,-4.88273125071,-5.12482657871,-4.37171907718,-4.08789165435,-7.7909858381,-5.66153387585,-4.39064352276,-0.107586092142,-6.29740973115,-6.74201877992,-6.74802480398,-4.21437580146,-8.42602538785,-7.6779624497,-5.64340649125,-4.68452287872,-5.11477624286,-7.25484240635,-7.03973102673,-5.89771942253,-12.5531597729,-12.5531597729,-12.5531597729,-12.5531597729},\
// {-10.8689302879,-4.32934433225,-3.46221955769,-3.88514032261,-4.00199700341,-7.18005083376,-4.18057557392,-4.2303624987,-4.64834011777,-0.230865745011,-6.51222146118,-5.70414431395,-4.14149856302,-7.82440785015,-6.4744811332,-5.23771850605,-4.77310572544,-4.97452745361,-8.22987295825,-3.28976232047,-6.40302216922,-10.8689302879,-10.8689302879,-10.8689302879,-10.8689302879},\
// {-12.1804624871,-5.82262022062,-5.88889334757,-5.48713881885,-5.88335316719,-8.51690084099,-5.46750628645,-6.4901030328,-6.23242749794,-7.76162187933,-0.0811457748379,-4.56467141509,-5.23252541851,-5.75397402967,-7.00431275455,-7.0805960593,-6.10972475912,-5.09205370845,-8.77926510546,-5.72369283155,-3.71057056883,-12.1804624871,-12.1804624871,-11.4873153066,-12.1804624871},\
// {-12.3600204476,-5.14846371432,-5.47655786122,-6.91328307597,-6.78029062165,-7.88268363316,-6.18415317753,-6.53107483003,-6.43043130425,-7.07175341694,-4.8188679925,-0.0498355652242,-6.30793127871,-6.6730450913,-5.39588483522,-5.76287474575,-6.09281989909,-6.27324572072,-8.11152520559,-5.86778061262,-5.52268763295,-12.3600204476,-12.3600204476,-11.6668732671,-12.3600204476},\
// {-12.9568304988,-5.36648355315,-4.30931104566,-3.84366203853,-4.60239155864,-9.52284329427,-3.77880672826,-3.87762439481,-4.65184091862,-6.23781734437,-6.07439302776,-6.79985151317,-0.139357748618,-7.53188048128,-8.86248593653,-6.05912555563,-5.12046073821,-4.61709073274,-8.76717575673,-6.49692604438,-6.54173353959,-12.9568304988,-12.9568304988,-11.8582182101,-12.9568304988},\
// {-9.54674117747,-6.08100527468,-4.60509875487,-4.52946134066,-4.25847414678,-6.32786535261,-4.43475338912,-4.94157099149,-4.90235027833,-5.93582326483,-3.01295233954,-3.79416853865,-3.95949251907,-0.23285192987,-6.50221873975,-6.77415245524,-5.19003235079,-3.75068342671,-6.90768384786,-5.05810480774,-4.65639204925,-9.54674117747,-9.54674117747,-9.54674117747,-9.54674117747},\
// {-11.8514384749,-7.98023746403,-7.8083872071,-6.71564003789,-7.04741743021,-7.66178373291,-7.88114656139,-8.06724884102,-6.88859384468,-7.67705120504,-6.88859384468,-4.73099410255,-7.77390103103,-9.28648911748,-0.0880267022629,-7.69255539158,-5.92184933155,-7.44471922767,-8.90699949577,-2.75393091124,-7.05564792934,-11.8514384749,-11.8514384749,-11.1582912944,-11.8514384749},\
// {-11.6541385279,-4.43522882025,-5.24067957071,-5.16341499337,-4.93512537349,-7.32340518759,-4.99869817751,-4.95587047376,-4.76760688534,-6.07064221909,-6.6843252283,-5.10305819283,-4.68717138926,-10.0447006154,-7.40564328582,-0.103898010523,-4.95587047376,-4.70812453677,-7.33665041434,-7.21148727138,-4.74838525156,-11.6541385279,-11.6541385279,-10.9609913473,-11.6541385279},\
// {-11.6460830377,-4.37091071828,-4.68478699182,-3.56522661809,-4.07512445456,-6.70444061512,-5.16757339552,-4.45691529931,-3.74878656514,-5.48910405215,-5.5324008579,-5.35266375889,-3.80695138946,-7.67579112418,-5.57765744949,-4.96899957649,-0.203494203833,-3.91987038723,-7.47169576784,-5.20036321835,-5.91923529015,-11.6460830377,-11.6460830377,-10.9529358572,-11.6460830377},\
// {-12.360200468,-4.37880888637,-5.16351389712,-4.63487043004,-4.52067488625,-8.33484877722,-5.32757620693,-4.70433645034,-4.92122887556,-6.78425136481,-5.33288595391,-6.56110781349,-4.01427020597,-6.82681097923,-8.0163950461,-5.5058459657,-4.66535239557,-0.111748640948,-9.14132464309,-5.86191831848,-6.14960039093,-12.360200468,-12.360200468,-11.6670532874,-12.360200468},\
// {-11.4922736772,-7.31788640734,-6.8971538271,-8.54783469807,-8.16006916706,-8.65906033318,-7.1747855637,-7.54102995866,-6.55063125463,-8.60190191934,-9.70051420801,-7.21560755822,-7.52198176369,-9.18968858425,-8.49654140369,-7.16154033695,-7.27276597206,-8.27339785237,-0.0091066344334,-8.54783469807,-8.44775123952,-11.4922736772,-11.4922736772,-11.4922736772,-11.4922736772},\
// {-12.4029625665,-6.8538864816,-6.06084114778,-5.01773164343,-5.56027928426,-7.71161468427,-6.46806837088,-6.66316965432,-6.85778512202,-4.87087442296,-6.58883203467,-6.01945593162,-6.05557335684,-9.26746835057,-3.4087901321,-7.93705444784,-6.067908315,-5.86917372857,-9.07075805632,-0.0740972323825,-7.44011793624,-12.4029625665,-12.4029625665,-10.6112030973,-12.4029625665},\
// {-11.8982286813,-4.45690829154,-6.43016854012,-6.00382584699,-5.5508394716,-6.85480356434,-5.5992794344,-5.44933928711,-5.08478408174,-7.52878082879,-3.51000587114,-5.08478408174,-5.36153708366,-7.17972980996,-7.2442683311,-4.99247540494,-6.27782781554,-5.62346666001,-8.37186815664,-6.9709749961,-0.0955108720231,-11.8982286813,-11.8982286813,-11.2050815007,-11.8982286813},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-4.35670882669,-2.97041446557,-2.56494935746,-2.74727091426,-2.56494935746,-2.97041446557,-2.56494935746,-2.41079867763,-3.25809653802,-3.66356164613,-3.66356164613,-3.66356164613,-3.25809653802,-4.35670882669,-3.66356164613,-3.66356164613,-4.35670882669,-2.41079867763,-4.35670882669,-2.56494935746,-3.25809653802,-4.35670882669,-4.35670882669,-4.35670882669,-4.35670882669},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487}};

/*Third iteration*/

// double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};


// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-12.0875311974,-0.0953636592774,-6.23532871758,-5.29294461648,-5.01850777077,-7.36014337864,-5.69729053029,-4.39496154928,-4.34382793918,-5.75247694585,-5.9984863219,-4.93682973976,-4.95423524246,-10.2957717281,-8.79169433135,-5.08628557528,-4.91280688752,-4.52693003458,-9.04300875963,-6.94586764085,-5.98945691519,-12.0875311974,-12.0875311974,-11.3943840168,-12.0875311974},\
// {-12.5465724748,-6.62231667737,-0.0579069347299,-5.28675286442,-7.22845248094,-7.9414022888,-5.17382610838,-5.39665563865,-5.15762637717,-5.44985109629,-6.65492826296,-5.42855627032,-4.31946424044,-8.32706476961,-8.8089028565,-6.19568675807,-5.61803465662,-6.39596970634,-7.759080732,-6.67727556165,-9.02021195017,-12.5465724748,-12.5465724748,-11.4479601861,-12.5465724748},\
// {-12.4859707514,-5.86990556623,-5.40510285468,-0.0948137025533,-4.52914362928,-9.02023484857,-5.0094983702,-4.57501336852,-4.65713622378,-5.95072948035,-6.61385296189,-6.60543776497,-3.95310108057,-9.22787421334,-7.98616108104,-6.21877020282,-4.54788202447,-5.6540171858,-9.77792055026,-5.38429477975,-9.49023847781,-12.4859707514,-12.4859707514,-12.4859707514,-12.4859707514},\
// {-12.8366180948,-5.82180374355,-7.48951056411,-4.71009992605,-0.0450670018389,-11.7380058062,-6.63206033226,-4.41154019232,-5.52941578007,-6.51225913245,-8.06593347036,-8.6469633528,-5.68984591538,-8.57393821779,-10.0034047508,-6.76357356073,-6.36427180033,-5.69695775887,-10.5340330018,-6.34286425498,-7.63261140775,-12.8366180948,-12.8366180948,-11.7380058062,-12.8366180948},\
// {-11.6799472414,-7.10523626292,-7.31049938895,-7.70965532787,-9.88818777219,-0.00657098407322,-8.31265141143,-8.84673389736,-6.97946687563,-9.28205196862,-10.2936528803,-7.70965532787,-8.50189341107,-10.9868000609,-8.1535867168,-8.54445302549,-7.1690877349,-9.11499788396,-9.28205196862,-7.00711840696,-10.2936528803,-11.6799472414,-11.6799472414,-10.9868000609,-11.6799472414},\
// {-12.0153720827,-5.62849276334,-4.61109296467,-4.43518266476,-5.68743529898,-8.61417470104,-0.126108271878,-3.82862929559,-5.2286551321,-5.66448636599,-5.98228586091,-5.43890251366,-3.31004094917,-7.99002039197,-7.88823769766,-5.48449445498,-5.6151146374,-5.48158324477,-8.301800016,-6.1864264651,-7.48277258955,-12.0153720827,-12.0153720827,-11.3222249021,-12.0153720827},\
// {-12.3542943551,-4.67043037487,-5.25840113403,-4.31127346983,-4.0771365827,-9.46392259723,-4.19864508476,-0.12168202341,-4.52109040649,-6.05534510827,-7.27912053989,-6.11401850996,-3.8900800885,-8.77077541667,-8.88855845233,-5.69885400476,-5.25015026214,-4.96534825751,-9.3097719174,-6.64386733775,-7.30443834788,-12.3542943551,-12.3542943551,-10.967999994,-12.3542943551},\
// {-12.541043756,-4.6213239951,-5.02515467081,-4.40218700533,-4.74047110135,-7.8589125289,-5.60859586445,-4.54102966235,-0.0805459699446,-6.99586631155,-7.02359085956,-6.64664092176,-4.94364743581,-8.43016989185,-7.87760466191,-5.81481035367,-4.95170793285,-6.1660189362,-7.23277605862,-7.52376391921,-6.89559685838,-12.541043756,-12.541043756,-12.541043756,-12.541043756},\
// {-10.8613424035,-4.44297746755,-3.63077925008,-4.08028477755,-4.56607640205,-7.36483484202,-4.40143794911,-4.44297746755,-5.14103062688,-0.191805782408,-6.31804762122,-5.76759220268,-4.21365402992,-8.55875731049,-6.83599071275,-5.50475612882,-4.70860970878,-5.9785404809,-7.81681996576,-3.18951560561,-8.66411782615,-10.8613424035,-10.8613424035,-10.8613424035,-10.8613424035},\
// {-12.1668535324,-6.084634622,-6.20070679325,-5.89775724867,-6.57214215277,-9.86426843938,-6.49009973011,-6.76869083086,-6.91458010433,-7.47550565015,-0.0547289946911,-4.88960580574,-5.35891858868,-5.84788541863,-7.27650440415,-7.40467959758,-6.37383992399,-5.42988657437,-9.03135931645,-6.13137209985,-4.15384142201,-12.1668535324,-12.1668535324,-12.1668535324,-12.1668535324},\
// {-12.3503807601,-5.22188481445,-5.2611376051,-6.42079161674,-8.85387319866,-7.78603256866,-5.82535110228,-6.25455619769,-6.75939377962,-7.2877857271,-5.05804358395,-0.0398354929992,-6.57582921458,-7.30052475288,-5.8180464679,-5.97706097055,-6.10233788562,-7.62299294141,-8.52173936364,-6.22351157601,-7.26897639514,-12.3503807601,-12.3503807601,-12.3503807601,-12.3503807601},\
// {-12.9452108382,-5.5062392458,-4.45992119579,-3.94818745671,-5.23455751469,-9.68711430017,-4.06573843612,-4.12053294703,-5.22741462718,-6.15062425731,-5.99152662732,-6.56508830129,-0.106771271028,-8.13302648282,-10.1119974941,-6.44242079228,-5.07848855305,-5.09744830072,-9.20754121991,-6.62624272444,-7.67735267913,-12.9452108382,-12.9452108382,-12.9452108382,-12.9452108382},\
// {-9.52973911098,-6.09575190649,-4.76756517618,-4.64693718839,-4.59526517785,-7.4502975693,-4.98644432871,-4.96539091951,-5.00795053393,-6.35168528063,-3.02844944044,-4.08300173931,-4.49930118959,-0.182248900856,-6.43869665762,-6.58530013181,-5.5784953924,-4.15910108285,-5.5784953924,-5.14771247631,-5.37085602762,-9.52973911098,-9.52973911098,-9.52973911098,-9.52973911098},\
// {-11.8474457979,-8.06325616395,-8.01880440138,-6.68265982394,-8.32108527325,-7.78700278732,-7.76990835396,-7.72031141282,-7.04342475313,-7.8584617513,-6.93479091213,-4.87203187041,-9.20838846825,-9.2824964404,-0.0823151903077,-8.08624568217,-6.0126350608,-8.06325616395,-9.65022122053,-2.78120676986,-7.87715388431,-11.8474457979,-11.8474457979,-11.8474457979,-11.8474457979},\
// {-11.6517826504,-4.53133827796,-5.15500766016,-4.81767391154,-5.37513916101,-7.70053893177,-4.79532066576,-4.76423007869,-4.90302310286,-6.29519637568,-6.68893802009,-5.11654137934,-5.42722422107,-9.45455807301,-7.37511653133,-0.0895243113612,-4.8165980642,-5.02771742255,-7.49289956699,-7.20913139386,-6.48699667643,-11.6517826504,-11.6517826504,-10.9586354698,-11.6517826504},\
// {-11.6363547527,-4.44945373231,-4.65627881216,-3.5481000256,-4.96179336091,-6.77654234836,-5.10693591446,-4.47395725537,-4.11829057149,-5.67277540911,-5.8587024295,-5.24779334718,-4.10426660918,-8.45830092238,-5.73920088509,-4.93932050506,-0.153960662791,-4.8887682259,-7.78620715101,-5.53828047056,-8.13984719126,-11.6363547527,-11.6363547527,-11.6363547527,-11.6363547527},\
// {-12.3340963989,-4.80415302831,-6.03698707898,-5.28657917756,-5.24735846441,-9.50088305486,-5.85558675671,-4.98422269418,-5.90760794146,-8.07141652187,-5.58650987209,-7.37125176866,-4.75543954832,-7.34366381214,-8.44227610081,-5.84034255906,-5.42234909866,-0.05899221598,-10.9478020378,-6.41520254464,-7.24034619811,-12.3340963989,-12.3340963989,-11.6409492184,-12.3340963989},\
// {-11.4909763356,-7.80209688147,-6.8858061496,-8.27210051072,-8.85191900597,-8.92602697812,-7.57895333016,-8.23287979756,-6.34348185877,-9.29375175825,-9.54506618653,-7.7533067173,-8.78292613448,-8.85191900597,-9.69921686636,-7.90745739713,-7.55915070286,-9.41153479391,-0.00661496774041,-9.41153479391,-10.1046819745,-11.4909763356,-11.4909763356,-11.4909763356,-11.4909763356},\
// {-12.3981836291,-7.22203389657,-6.41676941789,-5.17634780386,-5.91354839351,-7.79301344316,-6.7112082728,-6.76339402597,-7.64459343804,-4.85279387953,-6.79976167015,-6.19362586658,-6.54598114937,-9.50781187125,-3.48651887109,-8.30383906692,-6.35792891787,-6.34609446022,-10.0955985361,-0.0630100158435,-8.54803602743,-12.3981836291,-12.3981836291,-10.7887457167,-12.3981836291},\
// {-11.9006542096,-4.42135457181,-6.37520127046,-5.83222862134,-5.0676224768,-7.32594323108,-5.19992310004,-5.38594151872,-4.88135755587,-7.30553435945,-3.30779711425,-5.11393725898,-4.95656700136,-7.17326639088,-7.05646712313,-4.8795702453,-6.13860282681,-5.28191522607,-8.28973629694,-6.70215717832,-0.116099837488,-11.9006542096,-11.9006542096,-10.5143598485,-11.9006542096},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-4.40671924726,-3.3081069586,-2.61495977804,-2.79728133483,-2.46080909821,-3.02042488614,-2.61495977804,-2.46080909821,-3.7135720667,-3.7135720667,-3.7135720667,-3.3081069586,-2.61495977804,-4.40671924726,-3.3081069586,-3.7135720667,-3.7135720667,-2.46080909821,-4.40671924726,-2.61495977804,-3.7135720667,-4.40671924726,-4.40671924726,-4.40671924726,-4.40671924726},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487}};

/*Fourth iteration*/
// double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};

// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-12.0772842727,-0.0827354497691,-6.17738691911,-5.63474410623,-5.21557293222,-7.78682483155,-5.68202267458,-4.44101466932,-4.44053216026,-5.80629584084,-6.00193824161,-5.04819670855,-5.27266975263,-10.1313741236,-8.98624181934,-5.0897940257,-5.21348088124,-4.63655056531,-9.51233491524,-8.06995108746,-6.20516648322,-12.0772842727,-12.0772842727,-11.3841370921,-12.0772842727},\
// {-12.5405607722,-6.57955543263,-0.0502607649141,-5.48870514929,-7.38150547303,-7.87712167814,-5.18683844185,-5.46729105479,-5.29919448893,-5.58783212762,-6.61898235261,-5.53567878254,-4.54289764523,-8.35090603022,-8.92964285961,-6.22701272597,-5.7709187954,-6.52196755775,-7.86773193779,-7.42256695983,-9.32168494738,-12.5405607722,-12.5405607722,-11.8474135917,-12.5405607722},\
// {-12.4727506693,-6.19610717993,-5.63327423104,-0.0742122604964,-5.01860959112,-9.21465413125,-5.10693783206,-4.92051338171,-4.87435133994,-6.24030265272,-6.84873316308,-7.1161643946,-4.09873524753,-9.83369333965,-8.05391006147,-6.62342588932,-4.68786137361,-5.86475004397,-10.0748553965,-5.5403027777,-9.70016194703,-12.4727506693,-12.4727506693,-12.4727506693,-12.4727506693},\
// {-12.8284968875,-5.92074160849,-7.44400182468,-5.10493441519,-0.0361915616255,-11.7298845988,-6.80747353812,-4.51293040391,-5.65224235545,-7.08870397529,-8.16505779336,-9.19091072774,-5.98261701221,-9.09082726919,-10.8825867384,-6.9204139493,-6.66098039658,-5.86909837534,-10.6312723101,-6.76471167878,-7.69269845042,-12.8284968875,-12.8284968875,-11.7298845988,-12.8284968875},\
// {-11.6791853882,-7.28473623354,-7.24836858937,-8.06826747557,-10.2928910271,-0.00586023776094,-8.18267782675,-8.58814293486,-7.15739681117,-9.59974384654,-10.2928910271,-7.76716238279,-8.73474640905,-10.9860382077,-8.21344948542,-8.58814293486,-7.32247656153,-9.88742591899,-9.37660029522,-7.09421790955,-10.9860382077,-11.6791853882,-11.6791853882,-10.9860382077,-11.6791853882},\
// {-12.0042685302,-5.65163913389,-4.60425901305,-4.51318093668,-6.03556097023,-8.3153890761,-0.110484906727,-3.91294725668,-5.35917756071,-5.69072048394,-5.92662628686,-5.52729616732,-3.54640080488,-8.3153890761,-7.71380908906,-5.58264626241,-5.63094874064,-5.69253372106,-8.53853262741,-6.30382495682,-7.66046310836,-12.0042685302,-12.0042685302,-11.3111213497,-12.0042685302},\
// {-12.3454867013,-4.6934159552,-5.29796947996,-4.4822199773,-4.15042901042,-9.63743650021,-4.25661791215,-0.106516174282,-4.77555904607,-6.12888060023,-7.33485140722,-6.42928463871,-4.00909622072,-8.91149949683,-8.8191261767,-5.90135544461,-5.61566263082,-5.08426160934,-9.63743650021,-6.8160576138,-7.59189651021,-12.3454867013,-12.3454867013,-10.9591923402,-12.3454867013},\
// {-12.5314008749,-4.72023748984,-5.11322005214,-4.57282397105,-4.85724795358,-8.02054136835,-5.66134746307,-4.70975774862,-0.0675629857076,-7.00197178735,-7.10645085738,-6.66776969927,-5.4174447653,-8.66019986396,-8.18759545301,-5.8455399278,-5.31836921503,-6.19634662337,-7.40743689546,-8.31189316969,-7.0179721287,-12.5314008749,-12.5314008749,-12.5314008749,-12.5314008749},\
// {-10.8528841863,-4.52673471315,-3.71322385034,-4.21431639714,-4.82943659335,-8.01967084225,-4.46768978731,-4.53571949956,-5.16252473198,-0.175407065367,-6.41023292982,-5.77771037107,-4.25029629412,-8.65565960897,-6.84555100107,-5.57476952708,-4.7821464583,-6.29900729471,-8.14483398521,-3.22290847928,-8.65565960897,-10.8528841863,-10.8528841863,-10.8528841863,-10.8528841863},\
// {-12.1623767336,-6.06430245143,-6.15356354815,-6.26247938001,-6.47879696626,-9.67747008381,-6.4290354567,-6.95837004652,-6.89968654469,-7.47102885137,-0.0500325194938,-4.96046041606,-5.52774337573,-5.92992871705,-7.4438778623,-7.52764774537,-6.67757980011,-5.57482671877,-9.67747008381,-6.62111318844,-4.16909440549,-12.1623767336,-12.1623767336,-12.1623767336,-12.1623767336},\
// {-12.3446295143,-5.4160916961,-5.29972439714,-6.77247548209,-9.04879264827,-8.11052300967,-5.9020893478,-6.46130712578,-6.7098399111,-7.35419692749,-5.08129989679,-0.0348907878257,-6.924094515,-7.50834760732,-5.97987875742,-6.01669273054,-6.18553412578,-8.20149478788,-8.58342939858,-6.66104974693,-7.41737582911,-12.3446295143,-12.3446295143,-12.3446295143,-12.3446295143},\
// {-12.9389067767,-5.73401426649,-4.55250587553,-4.07331277779,-5.57626150627,-9.89438433897,-4.15107594743,-4.24022570923,-5.44614647577,-6.13540151908,-6.10157396201,-6.7692960442,-0.0944309285978,-8.24755889446,-10.1056934326,-6.6566400298,-5.24042398881,-4.95036379395,-9.44239921523,-6.87744985776,-7.90195417428,-12.9389067767,-12.9389067767,-12.9389067767,-12.9389067767},\
// {-9.51473205799,-6.11353467633,-4.76979992963,-5.29522435281,-4.75255812319,-7.90529414556,-4.92976457932,-4.83260083087,-5.01492238766,-6.51899978444,-3.03929934129,-4.25204186909,-4.49745222118,-0.16602201675,-6.57029307882,-6.57029307882,-5.70806956822,-4.53112543628,-5.40385819382,-5.19724394445,-5.42038749577,-9.51473205799,-9.51473205799,-9.51473205799,-9.51473205799},\
// {-11.8406236073,-7.96942259636,-7.65096886525,-6.2058340041,-8.40663640279,-7.78018059673,-7.36328679279,-7.06993898281,-6.96542628407,-7.87033169372,-6.91336992211,-5.26694344031,-9.53803851428,-9.35571695748,-0.0716228427528,-7.35198723754,-6.06297128405,-8.15174415316,-9.76118206559,-2.9402109167,-8.07942349158,-11.8406236073,-11.8406236073,-11.8406236073,-11.8406236073},\
// {-11.644585107,-4.49388364937,-5.15538017564,-5.10499915134,-5.44814097917,-7.88338499127,-4.79764196738,-4.87264955112,-4.98914475659,-6.32157512782,-6.7173314218,-5.13135499605,-5.70969091134,-9.34200001397,-7.19023781071,-0.0806528886531,-5.07791267716,-5.21003858817,-7.6556010604,-7.73256210153,-6.60763250455,-11.644585107,-11.644585107,-10.9514379264,-11.644585107},\
// {-11.6185009575,-4.66005256422,-4.84771153361,-3.66623764886,-5.35891949345,-7.03353347885,-5.15859650314,-4.69782945327,-4.59296264288,-5.69692253788,-6.16746250395,-5.31588198177,-4.28482456186,-8.84591223528,-5.76917617757,-5.14615466302,-0.122355492589,-5.44471485362,-8.06315289603,-5.63456467683,-8.39962513265,-11.6185009575,-11.6185009575,-11.6185009575,-11.6185009575},\
// {-12.3251703722,-4.89743153162,-6.06750278427,-5.5040628999,-5.43659791259,-9.7602210147,-6.11859444543,-5.02200032092,-6.56626859828,-8.24763292825,-5.75568895174,-8.00768225862,-4.76821980014,-7.75045939365,-9.02933350615,-5.93492970509,-5.92325317543,-0.0498655504423,-11.2265580835,-6.59832262457,-7.34156375045,-12.3251703722,-12.3251703722,-11.6320231916,-12.3251703722},\
// {-11.4900047816,-8.27112895672,-6.99019511126,-8.27112895672,-8.85094745197,-9.54409463253,-7.72880466589,-8.49427250803,-6.44014877434,-9.18741968859,-9.69824531236,-7.72880466589,-8.85094745197,-8.71741605935,-10.1037104205,-8.15780027141,-7.6613633851,-9.69824531236,-0.00582864656809,-9.54409463253,-10.3913924929,-11.4900047816,-11.4900047816,-11.4900047816,-11.4900047816},\
// {-12.3959985492,-7.35257343226,-6.47979648658,-5.13970130949,-5.98253959202,-7.86339905603,-6.88661021256,-6.7261176262,-7.86339905603,-4.87630614507,-6.86656946167,-6.19548937514,-6.6402563356,-9.9110918994,-3.51973328923,-8.35294728135,-6.41458433793,-6.34862637014,-10.0934134562,-0.0609216179317,-8.58933605941,-12.3959985492,-12.3959985492,-10.7865606367,-12.3959985492},\
// {-11.8983171091,-4.47594340812,-6.41767818577,-5.80249254668,-5.08707273051,-7.55451168726,-5.21245616204,-5.40607727409,-4.90072112613,-6.96384317598,-3.31533617716,-5.18293372277,-4.95326604538,-7.08613275374,-7.119193616,-4.85079988775,-6.03184905218,-5.29980808049,-8.37195658449,-6.51841975557,-0.115043947624,-11.8983171091,-11.8983171091,-10.512022748,-11.8983171091},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
// {-4.40671924726,-3.3081069586,-2.61495977804,-2.79728133483,-2.46080909821,-3.3081069586,-2.61495977804,-2.32727770558,-3.7135720667,-3.7135720667,-3.7135720667,-3.3081069586,-2.79728133483,-4.40671924726,-3.3081069586,-3.3081069586,-3.7135720667,-2.46080909821,-4.40671924726,-2.61495977804,-3.7135720667,-4.40671924726,-4.40671924726,-4.40671924726,-4.40671924726},\
// {-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487}};

/*Fifth iteration*/

double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};


double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
{{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
{-12.0730097146,-0.0765784365077,-6.1896873261,-5.72562050493,-5.18443725502,-7.94587532954,-5.67774811647,-4.47913186998,-4.48013942674,-5.809611452,-6.07904828728,-5.28629276398,-5.36614737799,-10.1270995655,-8.89495588424,-5.13666697875,-5.30107415875,-4.81459756399,-10.1270995655,-8.16098670916,-6.3078186118,-12.0730097146,-12.0730097146,-11.379862534,-12.0730097146},\
{-12.5374354225,-6.62393241686,-0.0465936931471,-5.67677175105,-7.48757941524,-7.85530419537,-5.26712253642,-5.50923399044,-5.40254457093,-5.64682630235,-6.71438952701,-5.53801295499,-4.61553701147,-8.3033289179,-9.13623804083,-6.23664962783,-5.85783623665,-6.59463604737,-7.93226523651,-7.52015558568,-9.44639296914,-12.5374354225,-12.5374354225,-11.8442882419,-12.5374354225},\
{-12.4667662845,-6.47780486762,-5.72861378991,-0.0670818902721,-5.08651049608,-9.33127206858,-5.09464825617,-4.9427448693,-5.15021810733,-6.30978729892,-6.97782855835,-7.25728013167,-4.25175985175,-9.98185963472,-8.21827104246,-6.74318118256,-4.73002260206,-5.8986883731,-10.1641811915,-5.54807106549,-9.90181692705,-12.4667662845,-12.4667662845,-12.4667662845,-12.4667662845},\
{-12.8240974935,-6.05675436823,-7.58235047843,-5.21621942021,-0.03240441654,-11.4378031324,-6.79341223323,-4.6188790671,-5.7826858297,-7.15077422632,-8.22897764336,-9.32758993203,-6.03400025798,-9.39011028901,-10.8781873444,-6.97765871844,-6.96902557129,-5.92538295916,-10.8781873444,-6.89185230604,-8.1236171277,-12.8240974935,-12.8240974935,-12.1309503129,-12.8240974935},\
{-11.6787110531,-7.36122293959,-7.28426189845,-8.38287418712,-10.292416692,-0.00560739604559,-8.24472384864,-8.68297877957,-7.20137423865,-9.59926951144,-10.0692731407,-7.67137786789,-8.90612233088,-10.9855638726,-8.18220349166,-8.38287418712,-7.37464595992,-10.5800987645,-9.37612596013,-7.14611155997,-10.9855638726,-11.6787110531,-11.6787110531,-10.9855638726,-11.6787110531},\
{-11.9999705601,-5.61984802317,-4.62722419367,-4.50498432612,-6.11664817158,-8.38905264743,-0.105271767249,-3.94513033897,-5.40146153146,-5.72520853883,-6.00600913276,-5.55266469753,-3.60156090464,-8.33640891394,-7.70951111892,-5.65083156869,-5.66314482892,-6.04672722578,-8.56598335559,-6.3831994624,-8.02967864652,-11.9999705601,-11.9999705601,-11.3068233795,-11.9999705601},\
{-12.3410710865,-4.73717311799,-5.3316621538,-4.52344564346,-4.20777722529,-9.56848236427,-4.32508327549,-0.100302371686,-4.81059109127,-6.1589861798,-7.3041184841,-6.66431728424,-4.09175734025,-8.97377525653,-8.78572302502,-6.00247700831,-5.58996961758,-5.1541700661,-9.85616443672,-6.85213336036,-7.64059072072,-12.3410710865,-12.3410710865,-10.9547767254,-12.3410710865},\
{-12.5266622758,-4.74719530835,-5.14765414818,-4.70702597344,-5.04285558814,-8.03802590608,-5.66914821326,-4.74218904007,-0.0622758657142,-7.07134116045,-7.06283047078,-6.62676492223,-5.54194595569,-8.71999978604,-8.24999615679,-5.81857819196,-5.47480665285,-6.3549616784,-7.46406724278,-8.48361100797,-7.08858296689,-12.5266622758,-12.5266622758,-12.5266622758,-12.5266622758},\
{-10.849317669,-4.51426341749,-3.76929116906,-4.19645463963,-4.84543060188,-7.85358539543,-4.50017867761,-4.53939939076,-5.2361895626,-0.171033826864,-6.37198085451,-5.83868237489,-4.28828700309,-8.90340751993,-6.87902575544,-5.63983151615,-4.82345169516,-6.58663779195,-8.3644110192,-3.22372259686,-8.76987612731,-10.849317669,-10.849317669,-10.849317669,-10.849317669},\
{-12.148856583,-6.01763009349,-6.21132037789,-6.37120425975,-6.58051207921,-10.0694150413,-6.49988234481,-6.86565285423,-6.87074192374,-7.47602774851,-0.0366276929697,-5.00444940265,-5.60350692264,-5.92034557938,-7.50446568383,-7.6055618007,-6.86058955228,-5.58924134548,-9.84627148998,-6.75522903662,-5.50246606812,-12.148856583,-12.148856583,-12.148856583,-12.148856583},\
{-12.3415471491,-5.64327909498,-5.32314535002,-6.94791960274,-9.00934263892,-8.1671598792,-5.94461749388,-6.60497485161,-6.70319247976,-7.37173384952,-5.11679374332,-0.0329314532338,-7.03824224103,-7.53752610436,-6.00472141794,-6.00472141794,-6.1130361455,-8.40972151637,-8.67798550296,-6.68905796882,-7.47401269864,-12.3415471491,-12.3415471491,-12.3415471491,-12.3415471491},\
{-12.9357928063,-5.7331316098,-4.67685234333,-4.12101671778,-5.69227983166,-9.80029859039,-4.14979459822,-4.25274625082,-5.5706126803,-6.10599906881,-6.12896344593,-6.70334478977,-0.090337747245,-8.27235371221,-10.2277426052,-6.73123504375,-5.35101972871,-4.9475892093,-9.60358829615,-6.91963564662,-7.97294817606,-12.9357928063,-12.9357928063,-12.9357928063,-12.9357928063},\
{-9.51096334856,-5.90004543592,-4.59830846282,-5.33657607867,-4.80143314725,-7.56505319951,-4.81961546633,-4.81048298277,-5.08014654972,-6.51523107501,-3.05891439412,-4.35190804935,-4.54115004898,-0.162079167137,-6.46644091084,-6.62059159066,-5.90004543592,-4.64342889811,-5.50363016333,-5.27685684396,-5.50363016333,-9.51096334856,-9.51096334856,-9.51096334856,-9.51096334856},\
{-11.8386833647,-7.88743964609,-7.74433880245,-6.13823979128,-8.43748598301,-7.86839145112,-7.49487794282,-6.97114891422,-7.01840179907,-7.84969931811,-6.89704094206,-5.3165905665,-9.53609827168,-9.35377671489,-0.0695123162447,-7.45665673,-6.1021110672,-8.17512171854,-9.89277321562,-2.97125592615,-8.10101374639,-11.8386833647,-11.8386833647,-11.8386833647,-11.8386833647},\
{-11.640975613,-4.53683151999,-5.15025207848,-5.22915734527,-5.51192540292,-7.74915531487,-4.84191975092,-4.97912087244,-4.96263349833,-6.40986699613,-6.61053769159,-5.16400325009,-5.83584064407,-9.33839051999,-7.04585576285,-0.0760935736434,-5.23080073102,-5.29008989627,-7.67068369943,-7.83431312321,-6.66424187056,-11.640975613,-11.640975613,-10.9478284324,-11.640975613},\
{-11.6106599764,-4.71700362183,-4.86777934064,-3.69531180717,-5.56328779739,-7.17984317759,-5.15389032086,-4.96426946159,-4.74060656464,-5.68107083304,-6.26355244572,-5.29711193016,-4.4065106844,-9.12575332665,-5.76422120138,-5.28630101405,-0.112076873179,-5.57278905651,-8.11415241497,-5.71076262285,-8.61492770288,-11.6106599764,-11.6106599764,-11.6106599764,-11.6106599764},\
{-12.3208467143,-4.96776479382,-6.09827044627,-5.61888634834,-5.59581307217,-10.123622137,-6.23634730126,-5.07447863424,-6.59726161239,-8.33186266777,-5.77262761158,-8.17771198795,-4.82641649931,-7.93882007966,-9.10197088947,-5.9875670862,-6.06701790276,-0.0461252565029,-11.2222344257,-6.62375322783,-7.4155719359,-12.3208467143,-12.3208467143,-11.6276995338,-12.3208467143},\
{-11.489656838,-8.12236100804,-7.02374871938,-8.3541626221,-8.78160663693,-9.54374668898,-7.8520706783,-8.44513440031,-6.44623172111,-9.09176156523,-9.6978973688,-7.77608477133,-9.18707174504,-8.85059950842,-10.3910445494,-8.19381997203,-7.75198721975,-9.6978973688,-0.00564538322529,-9.54374668898,-10.3910445494,-11.489656838,-11.489656838,-11.489656838,-11.489656838},\
{-12.3944425409,-7.37056202001,-6.49180920746,-5.16532866307,-6.05584846266,-7.87265396381,-6.94340408729,-6.74899564322,-7.63226860606,-4.88073329302,-6.90138109752,-6.20823391696,-6.67741483945,-10.0918574479,-3.52391999575,-8.30009797864,-6.42573498087,-6.38317536645,-9.99654726806,-0.0600426457961,-10.0918574479,-12.3944425409,-12.3944425409,-11.0081481797,-12.3944425409},\
{-11.8970375445,-4.5062390228,-6.4289774034,-5.76798733447,-5.05649101524,-7.80269298231,-5.23518280399,-5.41852790232,-4.90954729753,-7.01423562194,-3.32063249348,-5.22373957676,-4.86618006841,-7.17853867324,-7.10954580175,-4.85039026668,-5.94379421024,-5.27563189277,-8.40052998306,-6.44599909097,-0.115215352012,-11.8970375445,-11.8970375445,-10.2875996321,-11.8970375445},\
{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487},\
{-4.40671924726,-3.3081069586,-2.61495977804,-2.79728133483,-2.46080909821,-3.3081069586,-2.61495977804,-2.46080909821,-3.7135720667,-3.7135720667,-3.7135720667,-3.3081069586,-2.79728133483,-4.40671924726,-3.3081069586,-3.3081069586,-3.7135720667,-2.46080909821,-4.40671924726,-2.61495977804,-3.3081069586,-4.40671924726,-4.40671924726,-4.40671924726,-4.40671924726},\
{-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487,-3.21887582487}};




double char_frequencies[NSTATE_AA]={2.55575050252e-7,0.0458355962374,0.0719062959636,0.068612700291,0.0976207240697,0.0297558363757,0.0424372147942,0.0599525397132,0.0720818760231,0.0134851619515,0.049724170627,0.0591395554783,0.107938288848,0.00386480590992,0.0354577157469,0.0294207774849,0.0300244457536,0.0595471976835,0.0244915014906,0.0612035795842,0.0375048718994,2.55575050252e-7,2.55575050252e-7,5.11150100505e-7,2.55575050252e-7};

/*
For nucleotides

	NUC		NUM
	---		---
	?		0
	T		1
	C		2
	A		3
	G		4
*/


double emiss_gap_nt[NSTATE_NT]={-2.995732274, -1.437587656, -1.437587656, -1.437587656, -1.437587656};

double emiss_match_nt[NSTATE_NT][NSTATE_NT]=\
{{-2.995732274, -2.995732274, -2.995732274, -2.995732274, -2.995732274},\
{-1.437587656, -0.105360516, -4.094344562, -4.094344562, -4.094344562},\
{-1.437587656, -4.094344562, -0.105360516, -4.094344562, -4.094344562},\
{-1.437587656, -4.094344562, -4.094344562, -0.105360516, -4.094344562},\
{-1.437587656, -4.094344562, -4.094344562, -4.094344562, -0.105360516}};


/*Structures*/

/*Stores all matrices - don't want to allocate them all the time*/
struct matrices {

	double ***m1_m;
	double ***m1_i;
	double ***m1_d;
	double ***m2_m;
	double ***m2_i;
	double ***m2_d;

	int *who_copy;

	int *maxpath_copy;
	int *maxpath_state;
	int *maxpath_pos;
	double *ppsum_match;
	double **ppsum_state;

	int maxl;
	double llk;

	double tb_divisor;

};



/*Function declarations*/

struct pars * get_pars(int argc, char *argv[]);
void kalign_fb(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
struct data * add_null_term(struct data *my_data);
void classify_sequences(struct pars *my_pars, struct data *my_data);
struct matrices * allocate_matrices(struct data *my_data, struct pars *my_pars);
void deallocate_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices);
void print_max_acc_alignment(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
void print_posterior_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
void print_forward_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target, FILE *ofp);
void print_backward_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target, FILE *ofp);
void kalign_vt(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);

#endif


