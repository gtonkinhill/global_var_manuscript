#if !defined MOSAIC_H
#define MOSAIC_H


#include<stdlib.h>
#include<stdio.h>
#include<math.h>
#include<string.h>
#include<time.h>

#define NSTATE_AA 25
#define NSTATE_NT 5
#define SMALL -1e6
#define VERYSMALL -9999999.0


long *idum;

		/*Amino acids - IUPAC convention

	    Abbreviation    Amino acid name
        ------------    ---------------

		???		? 0		 Missing data
        Ala     A 1      Alanine
        Arg     R 2      Arginine
        Asn     N 3      Asparagine
        Asp     D 4      Aspartic acid (Aspartate)
        Cys     C 5      Cysteine
        Gln     Q 6      Glutamine
        Glu     E 7      Glutamic acid (Glutamate)
        Gly     G 8      Glycine
        His     H 9      Histidine
        Ile     I 10     Isoleucine
        Leu     L 11     Leucine
        Lys     K 12     Lysine
        Met     M 13     Methionine
        Phe     F 14     Phenylalanine
        Pro     P 15     Proline
        Ser     S 16     Serine
        Thr     T 17     Threonine
        Trp     W 18     Tryptophan
        Tyr     Y 19     Tyrosine
        Val     V 20     Valine
        Asx     B 21     Aspartic acid or Asparagine
        Glx     Z 22     Glutamine or Glutamic acid.
        Xaa     X 23     Any amino acid.
        TERM    * 24     termination codon

*/

/*For amino acids*/

// /*Initial iteration*/

// double emiss_gap_aa[NSTATE_AA]={-3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825};


// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825, -3.218875825},\
// {-3.218875825, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031, -5.032614201},\
// {-3.218875825, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -5.032614201, -0.210721031}};


// /*Second iteration*/

// double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};


// double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
// {{-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625},\
// {-15.1848273625,-3.21477456311,-8.2790740862,-7.36841037882,-6.87269225487,-9.5046547535,-7.92853012282,-6.75602832186,-6.79251735325,-7.92994255244,-8.15840055382,-7.31887194858,-6.87588910992,-11.0904828003,-10.673967856,-7.29949812324,-7.1861560015,-6.51594365786,-10.5308670124,-8.95631635892,-7.05447381508,-15.1848273625,-15.1848273625,-13.5753894501,-15.1848273625},\
// {-15.1848273625,-8.2790740862,-2.70382359346,-7.56706778591,-8.04675432847,-9.91696920345,-7.03667092259,-7.3920656417,-6.99502774379,-7.09350608898,-8.18906120621,-7.60719352991,-5.83420344509,-9.62799930082,-10.4752971612,-8.04120975981,-7.51954264404,-7.2886467539,-9.70836381058,-8.15840055382,-8.99861873861,-15.1848273625,-15.1848273625,-13.1053858208,-15.1848273625},\
// {-15.1848273625,-7.36841037882,-7.56706778591,-2.82293970864,-5.61905281604,-10.8943679214,-7.23432492771,-6.5694191236,-6.32603225666,-7.49774720673,-7.88977094605,-9.10032794944,-5.38171278413,-9.73378890895,-9.45472757954,-8.0651917245,-6.43240395865,-6.74451521543,-11.5472412028,-7.11485921346,-8.68654521304,-15.1848273625,-15.1848273625,-13.5753894501,-15.1848273625},\
// {-15.1848273625,-6.87269225487,-8.04675432847,-5.61905281604,-2.41852483193,-11.0576929775,-7.1557203079,-5.65153430401,-6.05472138325,-7.64420583386,-8.37578805647,-9.03209466781,-6.1363002867,-9.47109455701,-10.0910771617,-7.83366913608,-6.92381757649,-6.63768709473,-11.2530017298,-7.64899689972,-8.1927309351,-15.1848273625,-15.1848273625,-12.9876027852,-15.1848273625},\
// {-15.1848273625,-9.5046547535,-9.91696920345,-10.8943679214,-11.0576929775,-3.51210717533,-11.2530017298,-11.214535449,-9.70003042902,-11.3136263516,-10.81537951,-10.2575736774,-10.9801347431,-11.8175315325,-10.3645457969,-10.2721724768,-9.67543902589,-10.867339249,-11.7190914597,-9.74674805359,-9.61267333034,-15.1848273625,-15.1848273625,-13.3930678933,-15.1848273625},\
// {-15.1848273625,-7.92853012282,-7.03667092259,-7.23432492771,-7.1557203079,-11.2530017298,-3.32441907198,-6.30856210256,-7.57843997274,-7.7811570725,-7.86827918533,-8.32626232772,-5.30522275044,-9.51150409534,-10.5119985281,-7.85180434813,-8.08893414142,-7.39744533603,-10.2360674721,-8.53067484233,-8.23881337142,-15.1848273625,-15.1848273625,-13.2389172135,-15.1848273625},\
// {-15.1848273625,-6.75602832186,-7.3920656417,-6.5694191236,-5.65153430401,-11.214535449,-6.30856210256,-2.98004554975,-6.34280083302,-7.87561499682,-8.94066046185,-8.68353769197,-5.41150544456,-10.0549286476,-10.8281185358,-7.81522664199,-7.29274894127,-6.79410483515,-10.6630387855,-8.70172001106,-8.09725365696,-15.1848273625,-15.1848273625,-12.5457700329,-15.1848273625},\
// {-15.1848273625,-6.79251735325,-6.99502774379,-6.32603225666,-6.05472138325,-9.70003042902,-7.57843997274,-6.34280083302,-2.73925368176,-8.25433259656,-8.61114719555,-8.62379669662,-6.16977221372,-10.0788818886,-9.57535556733,-7.59397523883,-6.60879938538,-7.05329665191,-9.35882725513,-8.96423719242,-7.75471322395,-15.1848273625,-15.1848273625,-14.0862150738,-15.1848273625},\
// {-15.1848273625,-7.92994255244,-7.09350608898,-7.49774720673,-7.64420583386,-11.3136263516,-7.7811570725,-7.87561499682,-8.25433259656,-4.54676281966,-10.1096535473,-9.26593350824,-7.7690503871,-11.1417760947,-10.2080936201,-8.88587811566,-8.36590329724,-8.74547699142,-11.750840158,-6.93603662882,-10.0788818886,-15.1848273625,-15.1848273625,-14.491680182,-15.1848273625},\
// {-15.1848273625,-8.15840055382,-8.18906120621,-7.88977094605,-8.37578805647,-10.81537951,-7.86827918533,-8.94066046185,-8.61114719555,-10.1096535473,-3.08551065023,-6.9127677403,-7.57645288813,-8.01086904276,-9.41963625973,-9.45797961493,-8.40037029988,-7.43378224454,-11.629479301,-8.30650089422,-6.06189844755,-15.1848273625,-15.1848273625,-14.0862150738,-15.1848273625},\
// {-15.1848273625,-7.31887194858,-7.60719352991,-9.10032794944,-9.03209466781,-10.2575736774,-8.32626232772,-8.68353769197,-8.62379669662,-9.26593350824,-6.9127677403,-2.8746424801,-8.38688694954,-8.77300909481,-7.44677506483,-7.91800001499,-8.21222111121,-8.53973639301,-10.2360674721,-8.05312885205,-7.66676318128,-15.1848273625,-15.1848273625,-14.0862150738,-15.1848273625},\
// {-15.1848273625,-6.87588910992,-5.83420344509,-5.38171278413,-6.1363002867,-10.9801347431,-5.30522275044,-5.41150544456,-6.16977221372,-7.7690503871,-7.57645288813,-8.38688694954,-2.36735461238,-8.98431818847,-10.414142738,-7.55923229038,-6.65412582107,-6.14895943239,-10.414142738,-8.0872785119,-8.01470781907,-15.1848273625,-15.1848273625,-13.5753894501,-15.1848273625},\
// {-15.1848273625,-11.0904828003,-9.62799930082,-9.73378890895,-9.47109455701,-11.8175315325,-9.51150409534,-10.0549286476,-10.0788818886,-11.1417760947,-8.01086904276,-8.77300909481,-8.98431818847,-5.87093811491,-11.688319801,-12.189095089,-10.3172929121,-8.82007660566,-12.0493331466,-10.4752971612,-9.68765913722,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625},\
// {-15.1848273625,-10.673967856,-10.4752971612,-9.45472757954,-10.0910771617,-10.3645457969,-10.5119985281,-10.8281185358,-9.57535556733,-10.2080936201,-9.41963625973,-7.44677506483,-10.414142738,-11.688319801,-3.42141558984,-10.2944782343,-8.49150369425,-10.1222323295,-11.5472412028,-5.44456487108,-9.76872696031,-15.1848273625,-15.1848273625,-14.0862150738,-15.1848273625},\
// {-15.1848273625,-7.29949812324,-8.04120975981,-8.0651917245,-7.83366913608,-10.2721724768,-7.85180434813,-7.81522664199,-7.59397523883,-8.88587811566,-9.45797961493,-7.91800001499,-7.55923229038,-12.189095089,-10.2944782343,-3.63458684516,-7.80457157409,-7.59094951791,-10.1741920684,-10.043163806,-7.58642803319,-15.1848273625,-15.1848273625,-14.0862150738,-15.1848273625},\
// {-15.1848273625,-7.1861560015,-7.51954264404,-6.43240395865,-6.92381757649,-9.67543902589,-8.08893414142,-7.29274894127,-6.60879938538,-8.36590329724,-8.40037029988,-8.21222111121,-6.65412582107,-10.3172929121,-8.49150369425,-7.80457157409,-3.74223852862,-6.78125089789,-10.3020254399,-8.10060094042,-8.81835691478,-15.1848273625,-15.1848273625,-14.491680182,-15.1848273625},\
// {-15.1848273625,-6.51594365786,-7.2886467539,-6.74451521543,-6.63768709473,-10.867339249,-7.39744533603,-6.79410483515,-7.05329665191,-8.74547699142,-7.43378224454,-8.53973639301,-6.14895943239,-8.82007660566,-10.1222323295,-7.59094951791,-6.78125089789,-2.93637553551,-11.2930070644,-7.97622702455,-8.2494569165,-15.1848273625,-15.1848273625,-13.1053858208,-15.1848273625},\
// {-15.1848273625,-10.5308670124,-9.70836381058,-11.5472412028,-11.2530017298,-11.7190914597,-10.2360674721,-10.6630387855,-9.35882725513,-11.750840158,-11.629479301,-10.2360674721,-10.414142738,-12.0493331466,-11.5472412028,-10.1741920684,-10.3020254399,-11.2930070644,-3.70166031971,-11.356185966,-11.195843316,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625},\
// {-15.1848273625,-8.95631635892,-8.15840055382,-7.11485921346,-7.64899689972,-9.74674805359,-8.53067484233,-8.70172001106,-8.96423719242,-6.93603662882,-8.30650089422,-8.05312885205,-8.0872785119,-10.4752971612,-5.44456487108,-10.043163806,-8.10060094042,-7.97622702455,-11.356185966,-2.8559620284,-9.55003775935,-15.1848273625,-15.1848273625,-12.7869320897,-15.1848273625},\
// {-15.1848273625,-7.05447381508,-8.99861873861,-8.68654521304,-8.1927309351,-9.61267333034,-8.23881337142,-8.09725365696,-7.75471322395,-10.0788818886,-6.06189844755,-7.66676318128,-8.01470781907,-9.68765913722,-9.76872696031,-7.58642803319,-8.81835691478,-8.2494569165,-11.195843316,-9.55003775935,-3.38210955328,-15.1848273625,-15.1848273625,-13.7985330014,-15.1848273625},\
// {-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625},\
// {-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625},\
// {-15.1848273625,-13.5753894501,-13.1053858208,-13.5753894501,-12.9876027852,-13.3930678933,-13.2389172135,-12.5457700329,-14.0862150738,-14.491680182,-14.0862150738,-14.0862150738,-13.5753894501,-15.1848273625,-14.0862150738,-14.0862150738,-14.491680182,-13.1053858208,-15.1848273625,-12.7869320897,-13.7985330014,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625},\
// {-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625,-15.1848273625}};


/*Third iteration*/

double emiss_gap_aa[NSTATE_AA]={-15.1979173724,-3.08180225765,-2.63404791242,-2.67394023742,-2.32169752966,-3.51468389173,-3.15789340799,-2.81243156197,-2.62561259861,-4.31715688301,-3.01069630651,-2.83111715085,-2.2223732819,-5.61622036191,-3.34408665398,-3.52933949858,-3.51841024199,-2.82184038308,-3.70499055389,-2.79138450806,-3.28932800792,-15.1979173724,-15.1979173724,-11.1374743618,-15.1979173724};


double emiss_match_aa[NSTATE_AA][NSTATE_AA]=\
{{-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-2.74867501807,-10.8177913117,-9.82659927164,-9.34506444479,-12.7918723377,-10.3069656879,-7.98949198243,-8.70086667675,-9.48865536441,-9.93540213149,-8.79550818385,-10.3069656879,-13.7081630696,-13.015015889,-8.84062861913,-8.68757744463,-8.92484669821,-12.6095507809,-11.1432137121,-10.290436386,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501},\
{-14.4013102501,-10.8177913117,-2.55364977093,-9.26551181309,-13.3026979615,-10.6877381834,-8.52919246067,-9.70082988435,-8.941724736,-8.87984933228,-10.8459621887,-9.27141153522,-8.76652064697,-11.3102677968,-12.7918723377,-9.32613643491,-9.27734627074,-10.2424271668,-9.86871075699,-10.9355743473,-13.7081630696,-14.4013102501,-14.4013102501,-13.3026979615,-14.4013102501},\
{-14.4013102501,-9.82659927164,-9.26551181309,-2.49753935906,-8.56357980298,-13.7081630696,-9.04472397547,-8.21922534343,-9.55712316368,-9.62218675703,-10.0192836155,-11.1432137121,-7.81651885776,-13.015015889,-12.3218687085,-10.5511626484,-8.45327526096,-9.24801865565,-11.1432137121,-8.7143348938,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-9.34506444479,-13.3026979615,-8.56357980298,-2.50885305909,-14.4013102501,-11.7622529205,-8.63611914736,-9.17020163329,-9.65637812178,-11.4055779766,-14.4013102501,-10.5726688537,-12.2040856728,-13.7081630696,-12.3218687085,-10.6877381834,-9.20281321888,-11.9164036004,-8.84835066522,-11.3102677968,-14.4013102501,-14.4013102501,-13.3026979615,-14.4013102501},\
{-14.4013102501,-12.7918723377,-10.6877381834,-13.7081630696,-14.4013102501,-3.25464841108,-13.7081630696,-14.4013102501,-11.2232564198,-14.4013102501,-14.4013102501,-11.2658160342,-13.7081630696,-14.4013102501,-12.2040856728,-14.4013102501,-11.0001128685,-14.4013102501,-12.4554001011,-10.6636406319,-14.4013102501,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501},\
{-14.4013102501,-10.3069656879,-8.52919246067,-9.04472397547,-11.7622529205,-13.7081630696,-3.17645359907,-7.8851171741,-10.0575048283,-9.67392243143,-12.0987251571,-9.06859145688,-7.78257126663,-14.4013102501,-12.0034149773,-9.17556357643,-10.7637240904,-11.06910574,-10.7637240904,-11.3567878124,-12.7918723377,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501},\
{-14.4013102501,-7.98949198243,-9.70082988435,-8.21922534343,-8.63611914736,-14.4013102501,-7.8851171741,-2.63201537708,-8.4878072445,-9.47405656499,-11.1824344253,-10.3069656879,-7.95877008367,-14.4013102501,-13.015015889,-10.1966176308,-9.4960354717,-8.98966419829,-11.3102677968,-9.69178004883,-11.693260049,-14.4013102501,-14.4013102501,-12.7918723377,-14.4013102501},\
{-14.4013102501,-8.70086667675,-8.941724736,-9.55712316368,-9.17020163329,-11.2232564198,-10.0575048283,-8.4878072445,-2.81997875251,-11.0340144202,-12.3218687085,-11.456871271,-10.6401101344,-14.4013102501,-14.4013102501,-10.6877381834,-9.24225495093,-11.5680969061,-10.7637240904,-13.7081630696,-11.0340144202,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501},\
{-14.4013102501,-9.48865536441,-8.87984933228,-9.62218675703,-9.65637812178,-14.4013102501,-9.67392243143,-9.47405656499,-11.0340144202,-4.1463562946,-9.756919351,-10.8177913117,-9.58912589477,-14.4013102501,-14.4013102501,-10.5511626484,-9.70996236791,-12.7918723377,-12.0987251571,-8.78818214375,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-9.93540213149,-10.8459621887,-10.0192836155,-11.4055779766,-14.4013102501,-12.0987251571,-11.1824344253,-12.3218687085,-9.756919351,-3.2215803958,-9.04945211667,-9.14381487812,-9.06859145688,-11.0340144202,-12.2040856728,-10.6401101344,-9.47405656499,-12.6095507809,-10.7637240904,-8.79183845496,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-8.79550818385,-9.27141153522,-11.1432137121,-14.4013102501,-11.2658160342,-9.06859145688,-10.3069656879,-11.456871271,-10.8177913117,-9.04945211667,-2.82402127935,-11.1054733841,-10.9673230457,-9.3973639442,-9.94696295389,-9.95865899365,-13.015015889,-11.4055779766,-10.9355743473,-12.2040856728,-14.4013102501,-14.4013102501,-13.3026979615,-14.4013102501},\
{-14.4013102501,-10.3069656879,-8.76652064697,-7.81651885776,-10.5726688537,-13.7081630696,-7.78257126663,-7.95877008367,-10.6401101344,-9.58912589477,-9.14381487812,-11.1054733841,-2.39031011033,-11.2658160342,-14.4013102501,-11.3102677968,-10.0318623977,-9.45966782753,-12.7918723377,-11.5109384922,-13.015015889,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-13.7081630696,-11.3102677968,-13.015015889,-12.2040856728,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-9.06859145688,-10.9673230457,-11.2658160342,-5.4656699164,-14.4013102501,-13.7081630696,-13.3026979615,-11.6287215279,-12.0034149773,-13.7081630696,-11.7622529205,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-13.015015889,-12.7918723377,-12.3218687085,-13.7081630696,-12.2040856728,-12.0034149773,-13.015015889,-14.4013102501,-14.4013102501,-11.0340144202,-9.3973639442,-14.4013102501,-14.4013102501,-3.42695851814,-12.7918723377,-9.77633743686,-14.4013102501,-13.7081630696,-7.64089555906,-12.7918723377,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501},\
{-14.4013102501,-8.84062861913,-9.32613643491,-10.5511626484,-12.3218687085,-14.4013102501,-9.17556357643,-10.1966176308,-10.6877381834,-10.5511626484,-12.2040856728,-9.94696295389,-11.3102677968,-13.7081630696,-12.7918723377,-4.03604027002,-9.68281137885,-10.0972451569,-14.4013102501,-14.4013102501,-13.3026979615,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-8.68757744463,-9.27734627074,-8.45327526096,-10.6877381834,-11.0001128685,-10.7637240904,-9.4960354717,-9.24225495093,-9.70996236791,-10.6401101344,-9.95865899365,-10.0318623977,-13.3026979615,-9.77633743686,-9.68281137885,-3.33704971259,-10.3237728062,-11.4055779766,-10.1966176308,-13.3026979615,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-8.92484669821,-10.2424271668,-9.24801865565,-9.20281321888,-14.4013102501,-11.06910574,-8.98966419829,-11.5680969061,-12.7918723377,-9.47405656499,-13.015015889,-9.45966782753,-11.6287215279,-14.4013102501,-10.0972451569,-10.3237728062,-2.73006566253,-12.7918723377,-8.92903957647,-14.4013102501,-14.4013102501,-14.4013102501,-13.015015889,-14.4013102501},\
{-14.4013102501,-12.6095507809,-9.86871075699,-11.1432137121,-11.9164036004,-12.4554001011,-10.7637240904,-11.3102677968,-10.7637240904,-12.0987251571,-12.6095507809,-11.4055779766,-12.7918723377,-12.0034149773,-13.7081630696,-14.4013102501,-11.4055779766,-12.7918723377,-3.13523206319,-13.7081630696,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-11.1432137121,-10.9355743473,-8.7143348938,-8.84835066522,-10.6636406319,-11.3567878124,-9.69178004883,-13.7081630696,-8.78818214375,-10.7637240904,-10.9355743473,-11.5109384922,-13.7081630696,-7.64089555906,-14.4013102501,-10.1966176308,-8.92903957647,-13.7081630696,-2.92076335924,-14.4013102501,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501},\
{-14.4013102501,-10.290436386,-13.7081630696,-14.4013102501,-11.3102677968,-14.4013102501,-12.7918723377,-11.693260049,-11.0340144202,-14.4013102501,-8.79183845496,-12.2040856728,-13.015015889,-11.7622529205,-12.7918723377,-13.3026979615,-13.3026979615,-14.4013102501,-14.4013102501,-14.4013102501,-4.31096975639,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501},\
{-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-13.7081630696,-13.3026979615,-14.4013102501,-13.3026979615,-13.7081630696,-13.7081630696,-12.7918723377,-13.7081630696,-14.4013102501,-14.4013102501,-13.3026979615,-14.4013102501,-14.4013102501,-13.7081630696,-14.4013102501,-14.4013102501,-13.015015889,-14.4013102501,-13.7081630696,-13.7081630696,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501},\
{-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501,-14.4013102501}};




double char_frequencies[NSTATE_AA]={2.55575050252e-7,0.0458355962374,0.0719062959636,0.068612700291,0.0976207240697,0.0297558363757,0.0424372147942,0.0599525397132,0.0720818760231,0.0134851619515,0.049724170627,0.0591395554783,0.107938288848,0.00386480590992,0.0354577157469,0.0294207774849,0.0300244457536,0.0595471976835,0.0244915014906,0.0612035795842,0.0375048718994,2.55575050252e-7,2.55575050252e-7,5.11150100505e-7,2.55575050252e-7};

/*
For nucleotides

	NUC		NUM
	---		---
	?		0
	T		1
	C		2
	A		3
	G		4
*/


double emiss_gap_nt[NSTATE_NT]={-2.995732274, -1.437587656, -1.437587656, -1.437587656, -1.437587656};

double emiss_match_nt[NSTATE_NT][NSTATE_NT]=\
{{-2.995732274, -2.995732274, -2.995732274, -2.995732274, -2.995732274},\
{-1.437587656, -0.105360516, -4.094344562, -4.094344562, -4.094344562},\
{-1.437587656, -4.094344562, -0.105360516, -4.094344562, -4.094344562},\
{-1.437587656, -4.094344562, -4.094344562, -0.105360516, -4.094344562},\
{-1.437587656, -4.094344562, -4.094344562, -4.094344562, -0.105360516}};


/*Structures*/

/*Stores all matrices - don't want to allocate them all the time*/
struct matrices {

	double ***m1_m;
	double ***m1_i;
	double ***m1_d;
	double ***m2_m;
	double ***m2_i;
	double ***m2_d;

	int *who_copy;

	int *maxpath_copy;
	int *maxpath_state;
	int *maxpath_pos;
	double *ppsum_match;
	double **ppsum_state;

	int maxl;
	double llk;

	double tb_divisor;

};



/*Function declarations*/

struct pars * get_pars(int argc, char *argv[]);
void kalign_fb(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
struct data * add_null_term(struct data *my_data);
void classify_sequences(struct pars *my_pars, struct data *my_data);
struct matrices * allocate_matrices(struct data *my_data, struct pars *my_pars);
void deallocate_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices);
void print_max_acc_alignment(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
void print_posterior_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);
void print_forward_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target, FILE *ofp);
void print_backward_matrices(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target, FILE *ofp);
void kalign_vt(struct data *my_data, struct pars *my_pars, struct matrices *my_matrices, int target);

#endif


